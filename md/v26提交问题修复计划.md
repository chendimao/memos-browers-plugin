# v26 提交问题修复实施计划

## 功能目标
- 修复提交 `ad69ffb1a046495f279f94c2670d6c9b02af61de` 引入的阻断问题与运行时错误。
- 保证 v26 在插件中的核心能力可用：列表读取、编辑、删除、附件上传与关联。
- 维持 v18/v24/v25 现有行为不回归。

## 基线与范围
- 基线分支（Base Branch）：`master`
- 本次仅做问题修复（Patch），不新增功能、不做结构重构。

## 技术方案 / 架构说明
- 修复 SFC 文件污染：清理 `App.vue` 中样式块后的误粘贴内容，恢复合法 Vue 单文件组件结构。
- 补齐 v26 API 适配层：在 `src/api/v26.js` 增加缺失方法（`updateMemo`、`deleteMemo`、必要的附件相关方法），并与现有调用方签名对齐。
- 统一列表参数协议：让 `v26.getMemos` 兼容现有调用参数（`offset/limit/visibility/content/tag`），内部转换为 v26 接口查询参数。
- 修正调用侧分支：在 `App.vue`、`MemosList.vue` 中为 v26 增加与 v25 等价的数据解包/分页/附件处理分支，避免对象与数组结构错配。

## 分步骤任务列表
1. 清理 `src/App.vue` 尾部误粘贴内容，确保文件可被 Vite/Vue 正常编译。
2. 在 `src/api/v26.js` 实现 `updateMemo` 与 `deleteMemo`，并保持错误处理风格与现有版本一致。
3. 调整 `src/api/v26.js` 的 `getMemos` 入参与查询构造，兼容当前调用方传参。
4. 在 `src/views/MemosList.vue` 为 v26 增加数据解包与分页字段处理（`data.memos`、`nextPageToken`）分支。
5. 在 `src/App.vue` 修正 v26 编辑附件流程：避免调用未实现方法，改为使用 v26 已有附件接口路径。
6. 本地执行构建验证：`npm run build`。
7. 手动核查关键流程（v26）：列表加载、分页加载、编辑保存、删除、带附件新建/编辑。

## 涉及文件
- `src/App.vue`
- `src/api/v26.js`
- `src/views/MemosList.vue`
- （如有必要）`src/api/index.js`（仅在接口映射需微调时）

## 潜在风险
- v26 服务端字段命名可能与当前推断不完全一致（如 `externalLink` 与 `external_link`），需在实现中做兼容读取。
- v26 过滤参数（visibility/content/tag）可能受后端 CEL 语法影响，若服务端拒绝需降级为客户端过滤。
- 编辑态附件策略若与服务端“全量替换/增量追加”语义不一致，可能出现旧附件覆盖问题，需通过手测确认。

## 验证标准
- 构建成功：`npm run build` 无报错。
- v26 下以下操作均成功且无控制台报错：
  - 获取列表与加载更多
  - 编辑 memo 并保存
  - 删除 memo
  - 上传附件并关联到 memo
